# 8.2 分布式文件系统HDFS（预习）

## 8.2.1 分布式文件系统概述

​	1.分布式文件系统的概念

​	为了满足文件存储的需要大容量、高可靠性、高可用性、高性能、动态可扩展性、易维护性的要求而提出了分布文件系统。分布式文件就是分布式+文件系统。从内部组织结构来看，分布式文件系统不再和普通的文件系统一样负责管理本地磁盘，它的文件内容和目录结构都不是存储在本地磁盘上，而是通过网络传输到远端系统上。通过计算机网络与结点相连。

​	2.最早的分布式文件系统

​	NFS(Network File System)是最早 的分布式文件系统，采用的是Master/Slave架构，NFS的最大功能是可以通过网络让不同的机器、不同的操作系统彼此共同分享和管理文件——可以通过NFS挂载远程主机的目录，访问该目录就像访问本地目录一样。

​	3.大数据环境下分布式文件系统的优化思路

​	大数据时代，要求分布式文件系统能够存储并管理PB级数据，能够处理非结构数据，注重数据的吞吐量，而且大数据的读写操作比列远超写操作。分布式文件系统上架构在集群环境中，集群结点实效是常态，但是分布式文件系统要实现任何一个节点实效都不会影响文件系统对用户提供服务。

## 8.2.2 HDFS的架构及读写流程

1.HDFS的架构

​	HDFS是一个典型的主从(master/Slave)架构。Master主节点(NameNode)也叫元数据节点（MetadataNode），是分布式文件系统的管理者，存储文件的元数据（MEtadata）。从节点叫DataNode——数据节点，提供真实数据文件的物理支持。架构图如下：一个NameNode管理多个DataNode：

![image-20220915150436385](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220915150436385.png)

​		Hadoop集群中包含大量的DataNode，DataNode响应客户端的读写请求，还响应Metadatanode对文件的创建、删除、移动复制等命令。此外，重要的信息（如与数据等）都会进行备份，存储到次级元数据节点上。在HDSF中，DataNode把存储文件块信息报告给MetadataNode，这种报文信息采用心跳机制。

​		在HDFS上的文件被分为多个64MB的块（Chunk）作为独立单元。通过块的存储不仅大大提高存储容量，还提升了容错和可靠的性能(通过块备份)。

2. HDFS的 读写读写流程

   ​	Master主节点（NameNode）管理文件系统的所有文件元数据，为所有的文件和目录提供一个树状结构的元数据信息；实现客户端的操作控制和存储任务的管理分配，即决定数据块到DataNode的映射。

   ​	（1）文件读取

   ​		HDFS读写操作如下，Client向NameNode发起文件读取请求；NameNode返回文件存储的DataNode的信息，client从DataNode读取文件信息。

   ​	（2）文件写入

   ​		Client向NameNode发起文件写入请求；NameNode根据文件大小和文件配置情况，返回给Client他所管理部分DataNode的信息，Client将文件划分为多个文件块。